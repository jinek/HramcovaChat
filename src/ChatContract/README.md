Эта сборка должна быть разделена на несколько (как минимум каждая директория в отдельной сборки).

Для простоты объединил всё здесь. Из за этого, например,консольный клиент имеет доступ к имплементации WebSocket.